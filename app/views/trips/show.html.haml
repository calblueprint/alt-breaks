%p#notice= notice

.cover-wrapper
  .cover-photo{:style => "background-image: url(#{@trip.cover_photo.url(:large)})" }
  .title-container
    .title
      = @trip.name
    .subtitle
      = '...' + @trip.subtitle.downcase
    .location
      = @trip.location


.container
  .row-fluid
    / .span12
    /   .row-fluid
    /     .well
    /       / Modal: Community Partners
    /       %a.btn{"data-toggle" => "modal", :href => "#cpModal#{@trip.id}", :role => "button"} Community Partners
    /       %br/
    /       .modal.hide.fade{"aria-hidden" => "true", "aria-labelledby" => "myModalLabel", :id => "cpModal#{@trip.id}", :role => "dialog", :tabindex => "-1"}
    /         .modal-header
    /           %button.close{"aria-hidden" => "true", "data-dismiss" => "modal", :type => "button"} ×
    /           %h3#myModalLabel Community Partners
    /         .modal-body
    /           - if @trip.partners.all.empty?
    /             No Community Partners
    /           - else
    /             .row-fluid
    /               - @trip.partners.all.each_slice(2) do |pset|
    /                 %ul.thumbnails
    /                 .row-fluid
    /                   - pset.each do |p|
    /                     %li.span6
    /                       .thumbnail
    /                         - if p.logo.exists?
    /                           = link_to(image_tag(p.logo.url(:medium)), "http://"+p.website)
    /                           = link_to p.name, "http://"+p.website
    /                         - else
    /                           = link_to(image_tag("/assets/community.jpg"), "http://"+p.website)
    /                           = link_to p.name, "http://"+p.website
    /         .modal-footer
    /           %button.btn{"aria-hidden" => "true", "data-dismiss" => "modal"} Close

  .row-fluid
    .span12
      .heading.center ABOUT THIS TRIP
      .text
        = @trip.description

- if @photos.any?
  .row-fluid.gray
    .container
      #photos-carousel.carousel.slide
        .span9
          .carousel-inner
            - first = true
            - @photos.each_slice(18).first.each do |photo|
              .item.cphoto{:class => "#{'active' if first}"}
                = image_tag photo.photo.url(:original), :class => "slide"
                .carousel-caption
                  = photo.caption
              - first = false
          .controls
            %a.carousel-control.left{"data-slide" => "prev", :href => "#photos-carousel"} ‹
            %a.carousel-control.right{"data-slide" => "next", :href => "#photos-carousel"} ›
        .span3
          .carousel-thumbnails
            - count = 0
            - @photos.each_slice(3) do |slice|
              .row-fluid
                - slice.each do |photo|
                  .span4
                    .carousel-thumbnail{"data-slide-to" => count, "data-target" => "#photos-carousel"}
                      = image_tag photo.photo.url(:thumb)
                    - count+=1
            = paginate @photos

.container
  .row-fluid
    .span12
      .heading.center MEET THE BREAK LEADERS
      - @trip.break_leaders.each do |leader|
        .leader
          .avatar
            - if leader.avatar.exists?
              = link_to(image_tag(leader.avatar.url(:medium)), user_path(leader.id))
            - else
              = link_to(image_tag("/assets/panda.png"), user_path(leader.id))
          .description
            .name
              = link_to(leader.name, user_path(leader.id))
            .bio
              = leader.about_me


- if @testimonies.any?
  .row-fluid.gray
    .container
      .heading.center TESTIMONIES
      #testimonies-carousel.carousel.slide
        .carousel-inner
          - first = true
          - @testimonies.each do |testimony|
            .item{:class => "#{'active' if first}"}
              .well
                .row-fluid
                  .span2
                    %a{:href => "#"}
                      /make this into a helper
                      - if testimony.user.avatar.exists?
                        .avatar= image_tag testimony.user.avatar.url(:original)
                      - else
                        %img.avatar{:alt => "", :src => "/assets/panda.jpg"}
                  .span10
                    .row-fluid
                      %strong Author:
                      = link_to(testimony.user.name, user_path(testimony.user.id))
                    .row-fluid
                      %br
                      = link_to(testimony.description, [@trip.current_trip_instance, testimony])
              - first = false

      #testimonies-controls-carousel.carousel.slide
        .carousel-inner
          - count = 0
          - first = true
          - @testimonies.each_slice(8) do |slice|
            .item{:class => "#{'active' if first}"}
              - slice.each do |testimony|
                %a.testimony-avatar{"data-slide-to" => count, "data-target" => "#testimonies-carousel"}
                  - if testimony.user.avatar.exists?
                    = image_tag testimony.user.avatar.url(:original)
                  - else
                    %img{:alt => "", :src => "/assets/panda.jpg"}
                - count += 1
            - first = false
        .controls
          %a.carousel-control.left{"data-slide" => "prev", :href => "#testimonies-controls-carousel"} ‹
          %a.carousel-control.right{"data-slide" => "next", :href => "#testimonies-controls-carousel"} ›

      / link_to 'See all', trip_testimonies_path(@trip.id)