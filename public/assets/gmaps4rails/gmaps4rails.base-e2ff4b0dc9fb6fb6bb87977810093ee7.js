(function(){var t;t={},console.log("GMAPS$RAILS IS BEING LOADED OR SOME SHIT"),t.triggerOldOnload=function(){return"function"==typeof t.oldOnload?t.oldOnload():void 0},t.loadMaps=function(){var e,i,n,s,r;r=[];for(e in t)s=t[e],n=e.search(/load/),-1===n?(i="load_"+e,r.push(t[i]())):r.push(void 0);return r},window.Gmaps=t,this.Gmaps4Rails=function(){function t(){this.map=null,this.serviceObject=null,this.visibleInfoWindow=null,this.userLocation=null,this.geolocationSuccess=function(){return!1},this.geolocationFailure=function(){return!1},this.callback=function(){return!1},this.customClusterer=function(){return!1},this.infobox=function(){return!1},this.jsTemplate=!1,this.default_map_options={id:"map",draggable:!0,detect_location:!1,center_on_user:!1,center_latitude:0,center_longitude:0,zoom:7,maxZoom:null,minZoom:null,auto_adjust:!0,auto_zoom:!0,bounds:[],raw:{}},this.default_markers_conf={title:"",picture:"",width:22,length:32,draggable:!1,do_clustering:!1,randomize:!1,max_random_distance:100,list_container:null,offset:0,raw:{}},this.markers=[],this.boundsObject=null,this.polygons=[],this.polylines=[],this.circles=[],this.markerClusterer=null,this.markerImages=[],this.polylines_conf={strokeColor:"#FF0000",strokeOpacity:1,strokeWeight:2,clickable:!1,zIndex:null}}return t.prototype.initialize=function(){return this.serviceObject=this.createMap(),this.map=this.serviceObject,(this.map_options.detect_location===!0||this.map_options.center_on_user===!0)&&this.findUserLocation(this),this.resetSidebarContent()},t.prototype.findUserLocation=function(t){var e,i;return navigator.geolocation?(i=function(e){return t.userLocation=t.createLatLng(e.coords.latitude,e.coords.longitude),t.map_options.center_on_user===!0&&t.centerMapOnUser(),t.geolocationSuccess()},e=function(){return t.geolocationFailure(!0)},navigator.geolocation.getCurrentPosition(i,e)):t.geolocationFailure(!1)},t.prototype.create_direction=function(){var t,e,i;return t=new google.maps.DirectionsRenderer,e=new google.maps.DirectionsService,t.setMap(this.serviceObject),this.direction_conf.display_panel&&t.setPanel(document.getElementById(this.direction_conf.panel_id)),t.setOptions({suppressMarkers:!1,suppressInfoWindows:!1,suppressPolylines:!1}),i={origin:this.direction_conf.origin,destination:this.direction_conf.destination,waypoints:this.direction_conf.waypoints,optimizeWaypoints:this.direction_conf.optimizeWaypoints,unitSystem:google.maps.DirectionsUnitSystem[this.direction_conf.unitSystem],avoidHighways:this.direction_conf.avoidHighways,avoidTolls:this.direction_conf.avoidTolls,region:this.direction_conf.region,travelMode:google.maps.DirectionsTravelMode[this.direction_conf.travelMode],language:"en"},e.route(i,function(e,i){return i===google.maps.DirectionsStatus.OK?t.setDirections(e):void 0})},t.prototype.create_circles=function(){var t,e,i,n,s;for(n=this.circles,s=[],e=0,i=n.length;i>e;e++)t=n[e],s.push(this.create_circle(t));return s},t.prototype.create_circle=function(t){var e;return t===this.circles[0]&&(null!=t.strokeColor&&(this.circles_conf.strokeColor=t.strokeColor),null!=t.strokeOpacity&&(this.circles_conf.strokeOpacity=t.strokeOpacity),null!=t.strokeWeight&&(this.circles_conf.strokeWeight=t.strokeWeight),null!=t.fillColor&&(this.circles_conf.fillColor=t.fillColor),null!=t.fillOpacity&&(this.circles_conf.fillOpacity=t.fillOpacity)),null!=t.lat&&null!=t.lng?(e=new google.maps.Circle({center:this.createLatLng(t.lat,t.lng),strokeColor:t.strokeColor||this.circles_conf.strokeColor,strokeOpacity:t.strokeOpacity||this.circles_conf.strokeOpacity,strokeWeight:t.strokeWeight||this.circles_conf.strokeWeight,fillOpacity:t.fillOpacity||this.circles_conf.fillOpacity,fillColor:t.fillColor||this.circles_conf.fillColor,clickable:t.clickable||this.circles_conf.clickable,zIndex:t.zIndex||this.circles_conf.zIndex,radius:t.radius}),t.serviceObject=e,e.setMap(this.serviceObject)):void 0},t.prototype.clear_circles=function(){var t,e,i,n,s;for(n=this.circles,s=[],e=0,i=n.length;i>e;e++)t=n[e],s.push(this.clear_circle(t));return s},t.prototype.clear_circle=function(t){return t.serviceObject.setMap(null)},t.prototype.hide_circles=function(){var t,e,i,n,s;for(n=this.circles,s=[],e=0,i=n.length;i>e;e++)t=n[e],s.push(this.hide_circle(t));return s},t.prototype.hide_circle=function(t){return t.serviceObject.setMap(null)},t.prototype.show_circles=function(){var t,e,i,n,s;for(n=this.circles,s=[],e=0,i=n.length;i>e;e++)t=n[e],s.push(this.show_circle(this.circle));return s},t.prototype.show_circle=function(t){return t.serviceObject.setMap(this.serviceObject)},t.prototype.create_polygons=function(){var t,e,i,n,s;for(n=this.polygons,s=[],e=0,i=n.length;i>e;e++)t=n[e],s.push(this.create_polygon(t));return s},t.prototype.create_polygon=function(t){var e,i,n,s,r,o,a,l,c,h,u,d;for(a=[],u=0,d=t.length;d>u;u++)o=t[u],s=this.createLatLng(o.lat,o.lng),a.push(s),o===t[0]&&(l=o.strokeColor||this.polygons_conf.strokeColor,c=o.strokeOpacity||this.polygons_conf.strokeOpacity,h=o.strokeWeight||this.polygons_conf.strokeWeight,i=o.fillColor||this.polygons_conf.fillColor,n=o.fillOpacity||this.polygons_conf.fillOpacity,e=o.clickable||this.polygons_conf.clickable);return r=new google.maps.Polygon({paths:a,strokeColor:l,strokeOpacity:c,strokeWeight:h,fillColor:i,fillOpacity:n,clickable:e,map:this.serviceObject}),t.serviceObject=r},t.prototype.create_markers=function(){return this.createServiceMarkersFromMarkers(),this.clusterize()},t.prototype.createServiceMarkersFromMarkers=function(){var t,e,i,n,s,r,o,a;for(a=this.markers,n=r=0,o=a.length;o>r;n=++r)s=a[n],null==this.markers[n].serviceObject&&(t=this.markers[n].lat,i=this.markers[n].lng,this.markers_conf.randomize&&(e=this.randomize(t,i),t=e[0],i=e[1]),this.markers[n].serviceObject=this.createMarker({marker_picture:this.markers[n].picture?this.markers[n].picture:this.markers_conf.picture,marker_width:this.markers[n].width?this.markers[n].width:this.markers_conf.width,marker_height:this.markers[n].height?this.markers[n].height:this.markers_conf.length,marker_title:this.markers[n].title?this.markers[n].title:null,marker_anchor:this.markers[n].marker_anchor?this.markers[n].marker_anchor:null,shadow_anchor:this.markers[n].shadow_anchor?this.markers[n].shadow_anchor:null,shadow_picture:this.markers[n].shadow_picture?this.markers[n].shadow_picture:null,shadow_width:this.markers[n].shadow_width?this.markers[n].shadow_width:null,shadow_height:this.markers[n].shadow_height?this.markers[n].shadow_height:null,marker_draggable:this.markers[n].draggable?this.markers[n].draggable:this.markers_conf.draggable,rich_marker:this.markers[n].rich_marker?this.markers[n].rich_marker:null,zindex:this.markers[n].zindex?this.markers[n].zindex:null,Lat:t,Lng:i,index:n}),this.createInfoWindow(this.markers[n]),this.createSidebar(this.markers[n]));return this.markers_conf.offset=this.markers.length},t.prototype.createImageAnchorPosition=function(t){return null===t?null:this.createPoint(t[0],t[1])},t.prototype.replaceMarkers=function(t,e){return null==e&&(e=!0),this.clearMarkers(),this.markers=new Array,e&&(this.boundsObject=this.createLatLngBounds()),this.resetSidebarContent(),this.markers_conf.offset=0,this.addMarkers(t,e)},t.prototype.addMarkers=function(t,e){return null==e&&(e=!0),this.markers=this.markers.concat(t),this.create_markers(),e?this.adjustMapToBounds():void 0},t.prototype.createSidebar=function(t){var e,i,n,s,r;return this.markers_conf.list_container?(r=document.getElementById(this.markers_conf.list_container),s=document.createElement("li"),e=document.createElement("a"),e.href="javascript:void(0);",n=null!=t.sidebar?t.sidebar:"Marker",e.innerHTML=n,i=this,e.onclick=this.sidebar_element_handler(i,t.serviceObject,"click"),s.appendChild(e),r.appendChild(s)):void 0},t.prototype.sidebar_element_handler=function(t,e,i){return function(){return t.map.panTo(e.position),google.maps.event.trigger(e,i)}},t.prototype.resetSidebarContent=function(){var t;return null!==this.markers_conf.list_container?(t=document.getElementById(this.markers_conf.list_container),t.innerHTML=""):void 0},t.prototype.adjustMapToBounds=function(){return this.map_options.auto_adjust||null!==this.map_options.bounds?(this.boundsObject=this.createLatLngBounds(),this.map_options.auto_adjust&&(this.extendBoundsWithMarkers(),this.updateBoundsWithPolylines(),this.updateBoundsWithPolygons(),this.updateBoundsWithCircles()),this.extendMapBounds(),this.adaptMapToBounds()):void 0},t.prototype.replacePolylines=function(t){return this.destroy_polylines(),this.polylines=t,this.create_polylines(),this.adjustMapToBounds()},t.prototype.destroy_polylines=function(){var t,e,i,n;for(n=this.polylines,e=0,i=n.length;i>e;e++)t=n[e],t.serviceObject.setMap(null);return this.polylines=[]},t.prototype.create_polylines=function(){var t,e,i,n,s;for(n=this.polylines,s=[],e=0,i=n.length;i>e;e++)t=n[e],s.push(this.create_polyline(t));return s},t.prototype.exists=function(t){return""!==t&&"undefined"!=typeof t},t.prototype.randomize=function(t,e){var i,n,s,r;return s=this.markers_conf.max_random_distance*this.random(),r=this.markers_conf.max_random_distance*this.random(),i=parseFloat(t)+180/Math.PI*(r/6378137),n=parseFloat(e)+90/Math.PI*(s/6378137)/Math.cos(t),[i,n]},t.prototype.mergeObjectWithDefault=function(t,e){var i,n,s;i={};for(n in t)s=t[n],i[n]=s;for(n in e)s=e[n],null==i[n]&&(i[n]=s);return i},t.prototype.mergeWithDefault=function(t){var e,i;return e=this["default_"+t],i=this[t],this[t]=this.mergeObjectWithDefault(i,e),!0},t.prototype.random=function(){return 2*Math.random()-1},t}()}).call(this);